{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/assets/js/analytics.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","e","id","loaded","gapi","analytics","ready","createComponent","initialize","this","activeUsers","auth","once","handleSignOut_","execute","polling_","stop","render_","isAuthorized","pollActiveUsers_","clearTimeout","timeout_","emit","container","document","getElementById","innerHTML","template","querySelector","pollingInterval","isNaN","Error","client","data","realtime","ids","metrics","then","result","totalResults","rows","onChange_","setTimeout","delta","handleSignIn_","authorize","clientid","google_analytics_client_id","ext","ActiveUsers","timeout","firstChild","style","display","on","element","className","replace","now","thisWeek","lastWeek","query","params","Promise","resolve","reject","report","Data","response","makeCanvas","canvas","createElement","ctx","getContext","width","height","offsetHeight","appendChild","generateLegend","items","map","item","color","fillColor","label","join","set","moment","subtract","day","format","all","results","data1","row","data2","labels","datasets","pointColor","pointStrokeColor","Chart","Line","thisYear","date","month","lastYear","len","length","undefined","Bar","err","console","error","stack","renderYearOverYearChart","colors","forEach","push","Doughnut","$newUsers","$returningUsers","li","v","defaults","global","animationSteps","animationEasing","responsive","maintainAspectRatio","window","dispatchEvent","Event"],"mappings":"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","file":"/publishable/assets/js/analytics.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 223);\n","// Active Users JS\n!function(t){function i(s){if(e[s])return e[s].exports;var n=e[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}var e={};return i.m=t,i.c=e,i.p=\"\",i(0)}([function(t,i){\"use strict\";gapi.analytics.ready(function(){gapi.analytics.createComponent(\"ActiveUsers\",{initialize:function(){this.activeUsers=0,gapi.analytics.auth.once(\"signOut\",this.handleSignOut_.bind(this))},execute:function(){this.polling_&&this.stop(),this.render_(),gapi.analytics.auth.isAuthorized()?this.pollActiveUsers_():gapi.analytics.auth.once(\"signIn\",this.pollActiveUsers_.bind(this))},stop:function(){clearTimeout(this.timeout_),this.polling_=!1,this.emit(\"stop\",{activeUsers:this.activeUsers})},render_:function(){var t=this.get();this.container=\"string\"==typeof t.container?document.getElementById(t.container):t.container,this.container.innerHTML=t.template||this.template,this.container.querySelector(\"strong\").innerHTML=this.activeUsers},pollActiveUsers_:function(){var t=this.get(),i=1e3*(t.pollingInterval||5);if(isNaN(i)||5e3>i)throw new Error(\"Frequency must be 5 seconds or more.\");this.polling_=!0,gapi.client.analytics.data.realtime.get({ids:t.ids,metrics:\"rt:activeUsers\"}).then(function(t){var e=t.result,s=e.totalResults?+e.rows[0][0]:0,n=this.activeUsers;this.emit(\"success\",{activeUsers:this.activeUsers}),s!=n&&(this.activeUsers=s,this.onChange_(s-n)),1==this.polling_&&(this.timeout_=setTimeout(this.pollActiveUsers_.bind(this),i))}.bind(this))},onChange_:function(t){var i=this.container.querySelector(\"strong\");i&&(i.innerHTML=this.activeUsers),this.emit(\"change\",{activeUsers:this.activeUsers,delta:t}),t>0?this.emit(\"increase\",{activeUsers:this.activeUsers,delta:t}):this.emit(\"decrease\",{activeUsers:this.activeUsers,delta:t})},handleSignOut_:function(){this.stop(),gapi.analytics.auth.once(\"signIn\",this.handleSignIn_.bind(this))},handleSignIn_:function(){this.pollActiveUsers_(),gapi.analytics.auth.once(\"signOut\",this.handleSignOut_.bind(this))},template:'<div class=\"ActiveUsers\">Active Users <strong class=\"ActiveUsers-value\"></strong></div>'})})}]);\n\ngapi.analytics.ready(function () {\n\n\tgapi.analytics.auth.authorize({\n\t\tcontainer: 'embed-api-auth-container',\n\t\tclientid: google_analytics_client_id\n\t});\n\n\tvar activeUsers = new gapi.analytics.ext.ActiveUsers({\n\t\tcontainer: 'active-users-container',\n\t\tpollingInterval: 5\n\t});\n\n\tactiveUsers.once('success', function () {\n\t\tvar element = this.container.firstChild;\n\t\tvar timeout;\n\t\tdocument.getElementById('embed-api-auth-container').style.display = 'none';\n\t\tthis.on('change', function () {\n\t\t\tvar element = this.container.firstChild;\n\t\t\tclearTimeout(timeout);\n\t\t\ttimeout = setTimeout(function () {\n\t\t\t\telement.className = element.className.replace(/ is-(increasing|decreasing)/g, '');\n\t\t\t}, 3000);\n\t\t});\n\t});\n\n\tvar data = { ids: ids };\n\tactiveUsers.set(data).execute();\n\trenderWeekOverWeekChart();\n\trenderYearOverYearChart();\n\trenderTopBrowsersChart();\n\trenderTopCountriesChart();\n\tnewVsReturning();\n\tgaReferral();\n\n\tfunction renderWeekOverWeekChart() {\n\t\tvar now = moment();\n\t\tvar thisWeek = query({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:date,ga:nthDay',\n\t\t\t'metrics': 'ga:users',\n\t\t\t'start-date': moment(now).subtract(1, 'day').day(0).format('YYYY-MM-DD'),\n\t\t\t'end-date': moment(now).format('YYYY-MM-DD')\n\t\t});\n\t\tvar lastWeek = query({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:date,ga:nthDay',\n\t\t\t'metrics': 'ga:users',\n\t\t\t'start-date': moment(now).subtract(1, 'day').day(0).subtract(1, 'week')\n\t\t\t\t\t.format('YYYY-MM-DD'),\n\t\t\t'end-date': moment(now).subtract(1, 'day').day(6).subtract(1, 'week')\n\t\t\t\t\t.format('YYYY-MM-DD')\n\t\t});\n\t\tPromise.all([thisWeek, lastWeek]).then(function (results) {\n\t\t\tvar data1 = results[0].rows.map(function (row) {\n\t\t\t\treturn +row[2];\n\t\t\t});\n\t\t\tvar data2 = results[1].rows.map(function (row) {\n\t\t\t\treturn +row[2];\n\t\t\t});\n\t\t\tvar labels = results[1].rows.map(function (row) {\n\t\t\t\treturn +row[0];\n\t\t\t});\n\t\t\tlabels = labels.map(function (label) {\n\t\t\t\treturn moment(label, 'YYYYMMDD').format('ddd');\n\t\t\t});\n\t\t\tvar data = {\n\t\t\t\tlabels: labels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Last Week',\n\t\t\t\t\t\tfillColor: 'rgba(200,200,200,0.5)',\n\t\t\t\t\t\tpointColor: 'rgba(150,150,150,1)',\n\t\t\t\t\t\tpointStrokeColor: '#fff',\n\t\t\t\t\t\tdata: data2\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'This Week',\n\t\t\t\t\t\tfillColor: 'rgba(100,100,100,0.5)',\n\t\t\t\t\t\tpointColor: 'rgba(65,65,65,1)',\n\t\t\t\t\t\tpointStrokeColor: '#fff',\n\t\t\t\t\t\tdata: data1\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tnew Chart(makeCanvas('chart-1-container')).Line(data);\n\t\t\tgenerateLegend('legend-1-container', data.datasets);\n\t\t});\n\t}\n\n\tfunction renderYearOverYearChart() {\n\t\tvar now = moment();\n\t\tvar thisYear = query({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:month,ga:nthMonth',\n\t\t\t'metrics': 'ga:users',\n\t\t\t'start-date': moment(now).date(1).month(0).format('YYYY-MM-DD'),\n\t\t\t'end-date': moment(now).format('YYYY-MM-DD')\n\t\t});\n\t\tvar lastYear = query({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:month,ga:nthMonth',\n\t\t\t'metrics': 'ga:users',\n\t\t\t'start-date': moment(now).subtract(1, 'year').date(1).month(0)\n\t\t\t\t\t.format('YYYY-MM-DD'),\n\t\t\t'end-date': moment(now).date(1).month(0).subtract(1, 'day')\n\t\t\t\t\t.format('YYYY-MM-DD')\n\t\t});\n\t\tPromise.all([thisYear, lastYear]).then(function (results) {\n\t\t\tvar data1 = results[0].rows.map(function (row) {\n\t\t\t\treturn +row[2];\n\t\t\t});\n\t\t\tvar data2 = results[1].rows.map(function (row) {\n\t\t\t\treturn +row[2];\n\t\t\t});\n\t\t\tvar labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\n\t\t\t\t'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n\t\t\tfor (var i = 0, len = labels.length; i < len; i++) {\n\t\t\t\tif (data1[i] === undefined) data1[i] = null;\n\t\t\t\tif (data2[i] === undefined) data2[i] = null;\n\t\t\t}\n\t\t\tvar data = {\n\t\t\t\tlabels: labels,\n\t\t\t\tdatasets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Last Year',\n\t\t\t\t\t\tfillColor: 'rgba(50,50,50,0.5)',\n\t\t\t\t\t\tdata: data2\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'This Year',\n\t\t\t\t\t\tfillColor: 'rgba(130,130,130,0.5)',\n\t\t\t\t\t\tdata: data1\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tnew Chart(makeCanvas('chart-2-container')).Bar(data);\n\t\t\tgenerateLegend('legend-2-container', data.datasets);\n\t\t})\n\t\t.catch(function (err) {\n\t\t\tconsole.error(err.stack);\n\t\t});\n\t}\n\n\tfunction renderTopBrowsersChart() {\n\t\tquery({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:browser',\n\t\t\t'metrics': 'ga:pageviews',\n\t\t\t'sort': '-ga:pageviews',\n\t\t\t'max-results': 5\n\t\t})\n\t\t.then(function (response) {\n\t\t\tvar data = [];\n\t\t\tvar colors = ['#333333', '#555555', '#777777', '#999999', '#cccccc'];\n            if( typeof response.rows !== 'undefined' ){\n    \t\t\tresponse.rows.forEach(function (row, i) {\n    \t\t\t\tdata.push({value: +row[1], color: colors[i], label: row[0]});\n    \t\t\t});\n    \t\t\tnew Chart(makeCanvas('chart-3-container')).Doughnut(data);\n    \t\t\t\tgenerateLegend('legend-3-container', data);\n            }\n\t\t});\n\t}\n\n\tfunction renderTopCountriesChart() {\n\t\tquery({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:country',\n\t\t\t'metrics': 'ga:sessions',\n\t\t\t'sort': '-ga:sessions',\n\t\t\t'max-results': 5\n\t\t})\n\t\t.then(function (response) {\n\t\t\tvar data = [];\n\t\t\tvar colors = ['#333333', '#555555', '#777777', '#999999', '#cccccc'];\n            if( typeof response.rows !== 'undefined' ){\n\t\t\t    response.rows.forEach(function (row, i) {\n    \t\t\t\tdata.push({\n    \t\t\t\t\tlabel: row[0],\n    \t\t\t\t\tvalue: +row[1],\n    \t\t\t\t\tcolor: colors[i]\n    \t\t\t\t});\n    \t\t\t});\n    \t\t\tnew Chart(makeCanvas('chart-4-container')).Doughnut(data);\n    \t\t\tgenerateLegend('legend-4-container', data);\n            }\n\t\t});\n\t}\n\n\tfunction newVsReturning() {\n\t\tquery({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:userType',\n\t\t\t'metrics': 'ga:users'\n\t\t})\n\t\t.then(function (response) {\n\t\t\tlet $newUsers = document.querySelector('.new-users');\n\t\t\tlet $returningUsers = document.querySelector('.returning-users');\n            if( typeof response.rows !== 'undefined'){\n    \t\t\t$newUsers.innerHTML = response.rows[0][1];\n                if(  response.rows[1]){\n    \t\t\t    $returningUsers.innerHTML = response.rows[1][1];\n                }\n            }\n\t\t});\n\t}\n\n\tfunction gaReferral() {\n\t\tquery({\n\t\t\t'ids': ids,\n\t\t\t'dimensions': 'ga:sourceMedium',\n\t\t\t'metrics': 'ga:sessions',\n\t\t\t'sort': '-ga:sessions',\n\t\t\t'max-results': 10\n\t\t})\n\t\t.then(function (response) {\n\t\t\tlet li = '';\n            if( typeof response.rows !== 'undefined' ){\n    \t\t\tresponse.rows.forEach(function(v){\n    \t\t\t\tli += '<tr><td lass=\"medium-source\">'+v[0]+'</td><td class=\"medium-sesh\">'+v[1]+'</td></tr>';\n    \t\t\t});\n    \t\t\tlet $tableBody = document.querySelector('.top-ten-sources tbody');\n    \t\t\t$tableBody.innerHTML = li;\n            }\n\t\t});\n\t}\n\n\tfunction query(params) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar data = new gapi.analytics.report.Data({query: params});\n\t\t\tdata.once('success', function (response) {\n\t\t\t\tresolve(response);\n\t\t\t})\n\t\t\t.once('error', function (response) {\n\t\t\t\treject(response);\n\t\t\t})\n\t\t\t.execute();\n\t\t});\n\t}\n\n\tfunction makeCanvas(id) {\n\t\tvar container = document.getElementById(id);\n\t\tvar canvas = document.createElement('canvas');\n\t\tvar ctx = canvas.getContext('2d');\n\t\tcontainer.innerHTML = '';\n\t\tcanvas.width = '100%' //container.offsetWidth;\n\t\tcanvas.height = container.offsetHeight;\n\t\tcontainer.appendChild(canvas);\n\t\treturn ctx;\n\t}\n\n\tfunction generateLegend(id, items) {\n\t\tvar legend = document.getElementById(id);\n\t\tlegend.innerHTML = items.map(function (item) {\n\t\t\tvar color = item.color || item.fillColor;\n\t\t\tvar label = item.label;\n\t\t\treturn '<li><i style=\"background:' + color + '\"></i>' + label + '</li>';\n\t\t}).join('');\n\t}\n\n\tChart.defaults.global.animationSteps = 60;\n\tChart.defaults.global.animationEasing = 'easeInOutQuart';\n\tChart.defaults.global.responsive = true;\n\tChart.defaults.global.maintainAspectRatio = false;\n\twindow.dispatchEvent(new Event('resize'));\n});\n"],"sourceRoot":""}